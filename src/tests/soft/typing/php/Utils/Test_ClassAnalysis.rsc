module tests::soft::typing::php::Utils::Test_ClassAnalysis

import lang::php::ast::AbstractSyntax;
import soft::typing::php::functions::DeltaOperator;
import soft::typing::php::functions::UnionOperator;
import soft::typing::php::elements::Identifier;
import soft::typing::php::constraints::ConstraintHelper;
import soft::typing::php::Utils::Analysis;
import soft::typing::php::Utils::AnalysisHelpers;
import soft::typing::php::elements::Function;
import lang::php::analysis::cfg::CFG;
import lang::php::analysis::cfg::Label;
import lang::php::analysis::cfg::Visualize;
import lang::php::analysis::cfg::BuildCFG;
import tests::soft::typing::php::helper::Test_SetComparator;
import lang::php::util::Utils;
import soft::typing::php::declarations::PublicDataTypes;
import soft::typing::php::elements::Class;
import soft::typing::php::cfg2::CollapseCFG;
import IO;

private loc localP=rootP+"Test_ClassAnalysis";

test bool testSimpleClass_SetGetTest()
{
	//Test a class with simple set, get calls. Also includes a forked node..
	
	fileTest="SimpleClass_SetGetTest.php";
	
	
	exitEnvm=runAnalysis(localP,fileTest);

	expect=(
	  lab(20):(
	    var("varB"):typeSet({Float()}),
	    var("obj"):typeSet({Object(
	          objHd(2),
	          objInst(
	            2,
	            (var("varA"):typeSet({String()})),
	            "MyClass",
	            {}))})
	  ),
	  lab(16):(
	    var("varB"):typeSet({Float()}),
	    var("obj"):typeSet({Object(
	          objHd(2),
	          objInst(
	            2,
	            (var("varA"):typeSet({Float()})),
	            "MyClass",
	            {}))})
	  ),
	  lab(31):(
	    var("varB"):typeSet({
	        Float(),
	        String()
	      }),
	    var("obj"):typeSet({Object(
	          objHd(2),
	          objInst(
	            2,
	            (var("varA"):typeSet({
	                  Float(),
	                  String()
	                })),
	            "MyClass",
	            {}))})
	  ),
	  lab(25):(
	    var("varB"):typeSet({Float()}),
	    var("obj"):typeSet({Object(
	          objHd(2),
	          objInst(
	            2,
	            (var("varA"):typeSet({Float()})),
	            "MyClass",
	            {}))})
	  ),
	  lab(34):(
	    var("varB"):typeSet({
	        Float(),
	        String()
	      }),
	    var("obj"):typeSet({Object(
	          objHd(2),
	          objInst(
	            2,
	            (var("varA"):typeSet({
	                  Float(),
	                  String()
	                })),
	            "MyClass",
	            {}))})
	  ),
	  lab(35):(
	    var("varB"):typeSet({Float()}),
	    var("obj"):typeSet({Object(
	          objHd(2),
	          objInst(
	            2,
	            (var("varA"):typeSet({Float()})),
	            "MyClass",
	            {}))})
	  ),
	  lab(14):(
	    var("varB"):typeSet({Float()}),
	    var("obj"):typeSet({Object(
	          objHd(2),
	          objInst(
	            2,
	            (var("varA"):typeSet({Float()})),
	            "MyClass",
	            {}))})
	  ),
	  lab(9):(
	    var("varB"):nullTypeRoot(),
	    var("obj"):typeSet({Object(
	          objHd(2),
	          objInst(
	            2,
	            (var("varA"):typeSet({Float()})),
	            "MyClass",
	            {}))})
	  ),
	  lab(36):(
	    var("varB"):typeSet({Float()}),
	    var("obj"):typeSet({Object(
	          objHd(2),
	          objInst(
	            2,
	            (var("varA"):typeSet({
	                  Float(),
	                  String()
	                })),
	            "MyClass",
	            {}))})
	  ),
	  lab(4):(
	    var("varB"):nullTypeRoot(),
	    var("obj"):typeSet({Object(
	          objHd(2),
	          objInst(
	            2,
	            (var("varA"):nullTypeRoot()),
	            "MyClass",
	            {}))})
	  ),
	  lab(33):(
	    var("varB"):nullTypeRoot(),
	    var("obj"):nullTypeRoot()
	  ),
	  lab(1):(
	    var("varB"):nullTypeRoot(),
	    var("obj"):nullTypeRoot()
	  )
	  );	

  
	
	return assertEquals(exitEnvm,expect,"TypeEnvironment","propagate");
}

test bool testSimpleClass_CopyObject()
{
	fileTest="SimpleClass_CopyObject.php";
	
	
	exitEnvm=runAnalysis(localP,fileTest);
	
	expect=(
	  lab(22):(
	    var("gamma"):nullTypeRoot(),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({
	                Float(),
	                Bool()
	              })),
	          "MyClass",
	          {}))}),
	    var("beta"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({
	                Float(),
	                Bool()
	              })),
	          "MyClass",
	          {}))}),
	    var("test"):typeSet({Float()})
	  ),
	  lab(48):(
	    var("gamma"):nullTypeRoot(),
	    var("alpha"):nullTypeRoot(),
	    var("beta"):nullTypeRoot(),
	    var("test"):nullTypeRoot()
	  ),
	  lab(49):(
	    var("gamma"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Int()})),
	          "MyClass",
	          {}))}),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Int()})),
	          "MyClass",
	          {}))}),
	    var("beta"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Int()})),
	          "MyClass",
	          {}))}),
	    var("test"):typeSet({Int()})
	  ),
	  lab(50):(
	    var("gamma"):nullTypeRoot(),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Float()})),
	          "MyClass",
	          {}))}),
	    var("beta"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Float()})),
	          "MyClass",
	          {}))}),
	    var("test"):typeSet({Float()})
	  ),
	  lab(26):(
	    var("gamma"):nullTypeRoot(),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Bool()})),
	          "MyClass",
	          {}))}),
	    var("beta"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Bool()})),
	          "MyClass",
	          {}))}),
	    var("test"):typeSet({Float()})
	  ),
	  lab(36):(
	    var("gamma"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({
	                Float(),
	                Bool()
	              })),
	          "MyClass",
	          {}))}),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({
	                Float(),
	                Bool()
	              })),
	          "MyClass",
	          {}))}),
	    var("beta"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({
	                Float(),
	                Bool()
	              })),
	          "MyClass",
	          {}))}),
	    var("test"):typeSet({
	        Float(),
	        Bool()
	      })
	  ),
	  lab(5):(
	    var("gamma"):nullTypeRoot(),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({String()})),
	          "MyClass",
	          {}))}),
	    var("beta"):nullTypeRoot(),
	    var("test"):nullTypeRoot()
	  ),
	  lab(32):(
	    var("gamma"):nullTypeRoot(),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({
	                Float(),
	                Bool()
	              })),
	          "MyClass",
	          {}))}),
	    var("beta"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({
	                Float(),
	                Bool()
	              })),
	          "MyClass",
	          {}))}),
	    var("test"):typeSet({
	        Float(),
	        Bool()
	      })
	  ),
	  lab(2):(
	    var("gamma"):nullTypeRoot(),
	    var("alpha"):nullTypeRoot(),
	    var("beta"):nullTypeRoot(),
	    var("test"):nullTypeRoot()
	  ),
	  lab(46):(
	    var("gamma"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Int()})),
	          "MyClass",
	          {}))}),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Int()})),
	          "MyClass",
	          {}))}),
	    var("beta"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Int()})),
	          "MyClass",
	          {}))}),
	    var("test"):typeSet({Int()})
	  ),
	  lab(15):(
	    var("gamma"):nullTypeRoot(),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Float()})),
	          "MyClass",
	          {}))}),
	    var("beta"):nullTypeRoot(),
	    var("test"):typeSet({Float()})
	  ),
	  lab(41):(
	    var("gamma"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Int()})),
	          "MyClass",
	          {}))}),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Int()})),
	          "MyClass",
	          {}))}),
	    var("beta"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Int()})),
	          "MyClass",
	          {}))}),
	    var("test"):typeSet({
	        Float(),
	        Bool()
	      })
	  ),
	  lab(10):(
	    var("gamma"):nullTypeRoot(),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Float()})),
	          "MyClass",
	          {}))}),
	    var("beta"):nullTypeRoot(),
	    var("test"):nullTypeRoot()
	  ),
	  lab(51):(
	    var("gamma"):nullTypeRoot(),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({
	                Float(),
	                Bool()
	              })),
	          "MyClass",
	          {}))}),
	    var("beta"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({
	                Float(),
	                Bool()
	              })),
	          "MyClass",
	          {}))}),
	    var("test"):typeSet({Float()})
	  ),
	  lab(19):(
	    var("gamma"):nullTypeRoot(),
	    var("alpha"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Float()})),
	          "MyClass",
	          {}))}),
	    var("beta"):typeSet({Object(
	        objHd(2),
	        objInst(
	          2,
	          (var("varA"):typeSet({Float()})),
	          "MyClass",
	          {}))}),
	    var("test"):typeSet({Float()})
	  )
	);
	
	return assertEquals(exitEnvm,expect,"TypeEnvironment","propagate");	
}

test bool testSimpleClass_TwoClasses()
{


	fileTest="SimpleClass_TwoClasses.php";
	
	exitEnvm=runAnalysis(localP,fileTest);
	expect=
	(
	  lab(22):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):nullTypeRoot(),
	    var("myMake"):nullTypeRoot(),
	    var("car"):nullTypeRoot(),
	    var("obj"):typeSet({Object(
	        objHd(3),
	        objInst(
	          3,
	          (
	            var("make"):typeSet({Int()}),
	            var("year"):typeSet({Int()})
	          ),
	          "ClassB",
	          {}))})
	  ),
	  lab(17):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):nullTypeRoot(),
	    var("myMake"):nullTypeRoot(),
	    var("car"):nullTypeRoot(),
	    var("obj"):typeSet({Object(
	        objHd(3),
	        objInst(
	          3,
	          (
	            var("make"):typeSet({Int()}),
	            var("year"):nullTypeRoot()
	          ),
	          "ClassB",
	          {}))})
	  ),
	  lab(31):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      }),
	    var("myMake"):nullTypeRoot(),
	    var("car"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      }),
	    var("obj"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      })
	  ),
	  lab(27):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):nullTypeRoot(),
	    var("myMake"):nullTypeRoot(),
	    var("car"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      }),
	    var("obj"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      })
	  ),
	  lab(5):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):nullTypeRoot(),
	    var("myMake"):nullTypeRoot(),
	    var("car"):nullTypeRoot(),
	    var("obj"):nullTypeRoot()
	  ),
	  lab(2):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):nullTypeRoot(),
	    var("myMake"):nullTypeRoot(),
	    var("car"):nullTypeRoot(),
	    var("obj"):nullTypeRoot()
	  ),
	  lab(44):(
	    var("myYear"):typeSet({
	        Int(),
	        Bool()
	      }),
	    var("honda"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      }),
	    var("myMake"):typeSet({
	        String(),
	        Int()
	      }),
	    var("car"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      }),
	    var("obj"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      })
	  ),
	  lab(46):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):nullTypeRoot(),
	    var("myMake"):nullTypeRoot(),
	    var("car"):nullTypeRoot(),
	    var("obj"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      })
	  ),
	  lab(8):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):nullTypeRoot(),
	    var("myMake"):nullTypeRoot(),
	    var("car"):nullTypeRoot(),
	    var("obj"):typeSet({Object(
	        objHd(4),
	        objInst(
	          4,
	          (
	            var("make"):typeSet({String()}),
	            var("year"):nullTypeRoot()
	          ),
	          "ClassA",
	          {}))})
	  ),
	  lab(41):(
	    var("myYear"):typeSet({
	        Int(),
	        Bool()
	      }),
	    var("honda"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      }),
	    var("myMake"):typeSet({
	        String(),
	        Int()
	      }),
	    var("car"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      }),
	    var("obj"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      })
	  ),
	  lab(43):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):nullTypeRoot(),
	    var("myMake"):nullTypeRoot(),
	    var("car"):nullTypeRoot(),
	    var("obj"):nullTypeRoot()
	  ),
	  lab(36):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      }),
	    var("myMake"):typeSet({
	        String(),
	        Int()
	      }),
	    var("car"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      }),
	    var("obj"):typeSet({
	        Object(
	          objHd(4),
	          objInst(
	            4,
	            (
	              var("make"):typeSet({String()}),
	              var("year"):typeSet({Bool()})
	            ),
	            "ClassA",
	            {})),
	        Object(
	          objHd(3),
	          objInst(
	            3,
	            (
	              var("make"):typeSet({Int()}),
	              var("year"):typeSet({Int()})
	            ),
	            "ClassB",
	            {}))
	      })
	  ),
	  lab(4):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):nullTypeRoot(),
	    var("myMake"):nullTypeRoot(),
	    var("car"):nullTypeRoot(),
	    var("obj"):nullTypeRoot()
	  ),
	  lab(45):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):nullTypeRoot(),
	    var("myMake"):nullTypeRoot(),
	    var("car"):nullTypeRoot(),
	    var("obj"):nullTypeRoot()
	  ),
	  lab(13):(
	    var("myYear"):nullTypeRoot(),
	    var("honda"):nullTypeRoot(),
	    var("myMake"):nullTypeRoot(),
	    var("car"):nullTypeRoot(),
	    var("obj"):typeSet({Object(
	        objHd(4),
	        objInst(
	          4,
	          (
	            var("make"):typeSet({String()}),
	            var("year"):typeSet({Bool()})
	          ),
	          "ClassA",
	          {}))})
	  )
	);	
	return assertEquals(exitEnvm,expect,"TypeEnvironment","propagate");
	
}


test bool testSimpleClass_FieldIsObject()
{

	fileTest="SimpleClass_FieldIsObject.php";
	
	exitEnvm=runAnalysis(localP,fileTest);
	
	expectEnvm=(
	lab(84):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Float()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):typeSet({Object(
                                        objHd(8),
                                        objInst(
                                          8,
                                          (var("cost"):typeSet({Float()})),
                                          "Material",
                                          {}))}),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):typeSet({String()}),
    var("new_piston"):typeSet({Float()}),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Float()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):typeSet({Object(
                              objHd(8),
                              objInst(
                                8,
                                (var("cost"):typeSet({Float()})),
                                "Material",
                                {}))}),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):typeSet({Float()}),
    objField(
      objHd(6),
      var("piston")):typeSet({Object(
          objHd(7),
          objInst(
            7,
            (
              var("material"):typeSet({Object(
                    objHd(8),
                    objInst(
                      8,
                      (var("cost"):typeSet({Float()})),
                      "Material",
                      {}))}),
              var("radius"):typeSet({Float()})
            ),
            "Piston",
            {}))}),
    var("old_piston"):typeSet({Float()}),
    objField(
      objHd(7),
      var("material")):typeSet({Object(
          objHd(8),
          objInst(
            8,
            (var("cost"):typeSet({Float()})),
            "Material",
            {}))}),
    var("old_mileage"):typeSet({Int()})
  ),
  lab(22):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Int()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):nullTypeRoot(),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):nullTypeRoot(),
    var("new_piston"):nullTypeRoot(),
    var("old_piston"):nullTypeRoot(),
    var("old_mileage"):nullTypeRoot(),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Int()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):nullTypeRoot(),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):nullTypeRoot()
  ),
  lab(16):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Int()}),
                        var("piston"):nullTypeRoot()
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("new_mileage"):nullTypeRoot(),
    var("old_cost"):nullTypeRoot(),
    var("new_piston"):nullTypeRoot(),
    var("old_piston"):nullTypeRoot(),
    var("old_mileage"):nullTypeRoot()
  ),
  lab(50):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Int()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):typeSet({Object(
                                        objHd(8),
                                        objInst(
                                          8,
                                          (var("cost"):typeSet({String()})),
                                          "Material",
                                          {}))}),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):typeSet({String()}),
    var("new_piston"):nullTypeRoot(),
    var("old_mileage"):typeSet({Int()}),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Int()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):typeSet({Object(
                              objHd(8),
                              objInst(
                                8,
                                (var("cost"):typeSet({String()})),
                                "Material",
                                {}))}),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):nullTypeRoot(),
    objField(
      objHd(6),
      var("piston")):typeSet({Object(
          objHd(7),
          objInst(
            7,
            (
              var("material"):typeSet({Object(
                    objHd(8),
                    objInst(
                      8,
                      (var("cost"):typeSet({String()})),
                      "Material",
                      {}))}),
              var("radius"):typeSet({Float()})
            ),
            "Piston",
            {}))}),
    var("old_piston"):typeSet({Float()})
  ),
  lab(92):(
    var("new_cost"):typeSet({Float()}),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Float()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):typeSet({Object(
                                        objHd(8),
                                        objInst(
                                          8,
                                          (var("cost"):typeSet({Float()})),
                                          "Material",
                                          {}))}),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):typeSet({String()}),
    var("new_piston"):typeSet({Float()}),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Float()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):typeSet({Object(
                              objHd(8),
                              objInst(
                                8,
                                (var("cost"):typeSet({Float()})),
                                "Material",
                                {}))}),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):typeSet({Float()}),
    objField(
      objHd(6),
      var("piston")):typeSet({Object(
          objHd(7),
          objInst(
            7,
            (
              var("material"):typeSet({Object(
                    objHd(8),
                    objInst(
                      8,
                      (var("cost"):typeSet({Float()})),
                      "Material",
                      {}))}),
              var("radius"):typeSet({Float()})
            ),
            "Piston",
            {}))}),
    var("old_piston"):typeSet({Float()}),
    objField(
      objHd(7),
      var("material")):typeSet({Object(
          objHd(8),
          objInst(
            8,
            (var("cost"):typeSet({Float()})),
            "Material",
            {}))}),
    var("old_mileage"):typeSet({Int()})
  ),
  lab(29):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Int()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):typeSet({Object(
                                        objHd(8),
                                        objInst(
                                          8,
                                          (var("cost"):typeSet({String()})),
                                          "Material",
                                          {}))}),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):nullTypeRoot(),
    var("new_piston"):nullTypeRoot(),
    var("old_mileage"):nullTypeRoot(),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Int()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):typeSet({Object(
                              objHd(8),
                              objInst(
                                8,
                                (var("cost"):typeSet({String()})),
                                "Material",
                                {}))}),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):nullTypeRoot(),
    objField(
      objHd(6),
      var("piston")):typeSet({Object(
          objHd(7),
          objInst(
            7,
            (
              var("material"):typeSet({Object(
                    objHd(8),
                    objInst(
                      8,
                      (var("cost"):typeSet({String()})),
                      "Material",
                      {}))}),
              var("radius"):typeSet({Float()})
            ),
            "Piston",
            {}))}),
    var("old_piston"):nullTypeRoot()
  ),
  lab(94):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):nullTypeRoot(),
    var("new_mileage"):nullTypeRoot(),
    var("old_cost"):nullTypeRoot(),
    var("new_piston"):nullTypeRoot(),
    var("old_piston"):nullTypeRoot(),
    var("old_mileage"):nullTypeRoot()
  ),
  lab(56):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Float()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):typeSet({Object(
                                        objHd(8),
                                        objInst(
                                          8,
                                          (var("cost"):typeSet({String()})),
                                          "Material",
                                          {}))}),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):typeSet({String()}),
    var("new_piston"):nullTypeRoot(),
    var("old_mileage"):typeSet({Int()}),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Float()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):typeSet({Object(
                              objHd(8),
                              objInst(
                                8,
                                (var("cost"):typeSet({String()})),
                                "Material",
                                {}))}),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):nullTypeRoot(),
    objField(
      objHd(6),
      var("piston")):typeSet({Object(
          objHd(7),
          objInst(
            7,
            (
              var("material"):typeSet({Object(
                    objHd(8),
                    objInst(
                      8,
                      (var("cost"):typeSet({String()})),
                      "Material",
                      {}))}),
              var("radius"):typeSet({Float()})
            ),
            "Piston",
            {}))}),
    var("old_piston"):typeSet({Float()})
  ),
  lab(4):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):nullTypeRoot(),
    var("new_mileage"):nullTypeRoot(),
    var("old_cost"):nullTypeRoot(),
    var("new_piston"):nullTypeRoot(),
    var("old_piston"):nullTypeRoot(),
    var("old_mileage"):nullTypeRoot()
  ),
  lab(6):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):nullTypeRoot(),
    var("new_mileage"):nullTypeRoot(),
    var("old_cost"):nullTypeRoot(),
    var("new_piston"):nullTypeRoot(),
    var("old_piston"):nullTypeRoot(),
    var("old_mileage"):nullTypeRoot()
  ),
  lab(71):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Float()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):typeSet({Object(
                                        objHd(8),
                                        objInst(
                                          8,
                                          (var("cost"):typeSet({Float()})),
                                          "Material",
                                          {}))}),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):typeSet({String()}),
    var("new_piston"):nullTypeRoot(),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Float()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):typeSet({Object(
                              objHd(8),
                              objInst(
                                8,
                                (var("cost"):typeSet({Float()})),
                                "Material",
                                {}))}),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):nullTypeRoot(),
    objField(
      objHd(6),
      var("piston")):typeSet({Object(
          objHd(7),
          objInst(
            7,
            (
              var("material"):typeSet({Object(
                    objHd(8),
                    objInst(
                      8,
                      (var("cost"):typeSet({Float()})),
                      "Material",
                      {}))}),
              var("radius"):typeSet({Float()})
            ),
            "Piston",
            {}))}),
    var("old_piston"):typeSet({Float()}),
    objField(
      objHd(7),
      var("material")):typeSet({Object(
          objHd(8),
          objInst(
            8,
            (var("cost"):typeSet({Float()})),
            "Material",
            {}))}),
    var("old_mileage"):typeSet({Int()})
  ),
  lab(2):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):nullTypeRoot(),
    var("new_mileage"):nullTypeRoot(),
    var("old_cost"):nullTypeRoot(),
    var("new_piston"):nullTypeRoot(),
    var("old_piston"):nullTypeRoot(),
    var("old_mileage"):nullTypeRoot()
  ),
  lab(35):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Int()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):typeSet({Object(
                                        objHd(8),
                                        objInst(
                                          8,
                                          (var("cost"):typeSet({String()})),
                                          "Material",
                                          {}))}),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):nullTypeRoot(),
    var("new_piston"):nullTypeRoot(),
    var("old_mileage"):typeSet({Int()}),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Int()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):typeSet({Object(
                              objHd(8),
                              objInst(
                                8,
                                (var("cost"):typeSet({String()})),
                                "Material",
                                {}))}),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):nullTypeRoot(),
    objField(
      objHd(6),
      var("piston")):typeSet({Object(
          objHd(7),
          objInst(
            7,
            (
              var("material"):typeSet({Object(
                    objHd(8),
                    objInst(
                      8,
                      (var("cost"):typeSet({String()})),
                      "Material",
                      {}))}),
              var("radius"):typeSet({Float()})
            ),
            "Piston",
            {}))}),
    var("old_piston"):nullTypeRoot()
  ),
  lab(77):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Float()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):typeSet({Object(
                                        objHd(8),
                                        objInst(
                                          8,
                                          (var("cost"):typeSet({Float()})),
                                          "Material",
                                          {}))}),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):typeSet({String()}),
    var("new_piston"):nullTypeRoot(),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Float()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):typeSet({Object(
                              objHd(8),
                              objInst(
                                8,
                                (var("cost"):typeSet({Float()})),
                                "Material",
                                {}))}),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):typeSet({Float()}),
    objField(
      objHd(6),
      var("piston")):typeSet({Object(
          objHd(7),
          objInst(
            7,
            (
              var("material"):typeSet({Object(
                    objHd(8),
                    objInst(
                      8,
                      (var("cost"):typeSet({Float()})),
                      "Material",
                      {}))}),
              var("radius"):typeSet({Float()})
            ),
            "Piston",
            {}))}),
    var("old_piston"):typeSet({Float()}),
    objField(
      objHd(7),
      var("material")):typeSet({Object(
          objHd(8),
          objInst(
            8,
            (var("cost"):typeSet({Float()})),
            "Material",
            {}))}),
    var("old_mileage"):typeSet({Int()})
  ),
  lab(8):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):nullTypeRoot(),
    var("new_mileage"):nullTypeRoot(),
    var("old_cost"):nullTypeRoot(),
    var("new_piston"):nullTypeRoot(),
    var("old_piston"):nullTypeRoot(),
    var("old_mileage"):nullTypeRoot()
  ),
  lab(42):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Int()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):typeSet({Object(
                                        objHd(8),
                                        objInst(
                                          8,
                                          (var("cost"):typeSet({String()})),
                                          "Material",
                                          {}))}),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):nullTypeRoot(),
    var("new_piston"):nullTypeRoot(),
    var("old_mileage"):typeSet({Int()}),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Int()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):typeSet({Object(
                              objHd(8),
                              objInst(
                                8,
                                (var("cost"):typeSet({String()})),
                                "Material",
                                {}))}),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):nullTypeRoot(),
    objField(
      objHd(6),
      var("piston")):typeSet({Object(
          objHd(7),
          objInst(
            7,
            (
              var("material"):typeSet({Object(
                    objHd(8),
                    objInst(
                      8,
                      (var("cost"):typeSet({String()})),
                      "Material",
                      {}))}),
              var("radius"):typeSet({Float()})
            ),
            "Piston",
            {}))}),
    var("old_piston"):typeSet({Float()})
  ),
  lab(11):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):nullTypeRoot()
            ),
            "Car",
            {}))}),
    var("new_mileage"):nullTypeRoot(),
    var("old_cost"):nullTypeRoot(),
    var("new_piston"):nullTypeRoot(),
    var("old_piston"):nullTypeRoot(),
    var("old_mileage"):nullTypeRoot()
  ),
  lab(95):(
    var("new_cost"):typeSet({Float()}),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Float()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):typeSet({Object(
                                        objHd(8),
                                        objInst(
                                          8,
                                          (var("cost"):typeSet({Float()})),
                                          "Material",
                                          {}))}),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):typeSet({String()}),
    var("new_piston"):typeSet({Float()}),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Float()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):typeSet({Object(
                              objHd(8),
                              objInst(
                                8,
                                (var("cost"):typeSet({Float()})),
                                "Material",
                                {}))}),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):typeSet({Float()}),
    objField(
      objHd(6),
      var("piston")):typeSet({Object(
          objHd(7),
          objInst(
            7,
            (
              var("material"):typeSet({Object(
                    objHd(8),
                    objInst(
                      8,
                      (var("cost"):typeSet({Float()})),
                      "Material",
                      {}))}),
              var("radius"):typeSet({Float()})
            ),
            "Piston",
            {}))}),
    var("old_piston"):typeSet({Float()}),
    objField(
      objHd(7),
      var("material")):typeSet({Object(
          objHd(8),
          objInst(
            8,
            (var("cost"):typeSet({Float()})),
            "Material",
            {}))}),
    var("old_mileage"):typeSet({Int()})
  ),
  lab(63):(
    var("new_cost"):nullTypeRoot(),
    var("myCar"):typeSet({Object(
          objHd(5),
          objInst(
            5,
            (
              var("model"):typeSet({String()}),
              var("engine"):typeSet({Object(
                    objHd(6),
                    objInst(
                      6,
                      (
                        var("mpg"):typeSet({Float()}),
                        var("piston"):typeSet({Object(
                              objHd(7),
                              objInst(
                                7,
                                (
                                  var("material"):typeSet({Object(
                                        objHd(8),
                                        objInst(
                                          8,
                                          (var("cost"):typeSet({String()})),
                                          "Material",
                                          {}))}),
                                  var("radius"):typeSet({Float()})
                                ),
                                "Piston",
                                {}))})
                      ),
                      "Engine",
                      {}))})
            ),
            "Car",
            {}))}),
    var("old_cost"):typeSet({String()}),
    var("new_piston"):nullTypeRoot(),
    var("old_mileage"):typeSet({Int()}),
    objField(
      objHd(5),
      var("engine")):typeSet({Object(
          objHd(6),
          objInst(
            6,
            (
              var("mpg"):typeSet({Float()}),
              var("piston"):typeSet({Object(
                    objHd(7),
                    objInst(
                      7,
                      (
                        var("material"):typeSet({Object(
                              objHd(8),
                              objInst(
                                8,
                                (var("cost"):typeSet({String()})),
                                "Material",
                                {}))}),
                        var("radius"):typeSet({Float()})
                      ),
                      "Piston",
                      {}))})
            ),
            "Engine",
            {}))}),
    var("new_mileage"):nullTypeRoot(),
    objField(
      objHd(6),
      var("piston")):typeSet({Object(
          objHd(7),
          objInst(
            7,
            (
              var("material"):typeSet({Object(
                    objHd(8),
                    objInst(
                      8,
                      (var("cost"):typeSet({String()})),
                      "Material",
                      {}))}),
              var("radius"):typeSet({Float()})
            ),
            "Piston",
            {}))}),
    var("old_piston"):typeSet({Float()})
  ));

	return assertEquals(exitEnvm,expectEnvm,"map[Lab,TypeEnvironment]","propagate");
}